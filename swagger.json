{
  "swagger": "2.0",
  "info": {
    "description": "DDog API List",
    "version": "1.0.0",
    "title": "DDOG API ",
    "termsOfService": "http://127.0.0.1:8000",
    "contact": {
      "email": "ztao@gmail.com"
    },
    "license": {
      "name": "Apache 2.0",
      "url": "http://www.apache.org/licenses/LICENSE-2.0.html"
    }
  },
  "host": "127.0.0.1:8000",
  "basePath": "/v1",
  "tags": [
    {
      "name": "cluster",
      "description": "集群操作API"
    },
    {
      "name": "metadata",
      "description": "元数据操作API"
    },
    {
      "name": "svc",
      "description": "服务操作API"
    },
    {
      "name": "namespace",
      "description": "命名空间操作API"
    },
    {
      "name": "dns",
      "description": "DNS操作API"
    },
    {
      "name": "container",
      "description": "容器操作API"
    },
    {
      "name": "svcor",
      "description": "服务编排API"
    }
  ],
  "schemes": [
    "http"
  ],
  "paths": {
    "/_ping": {
      "get": {
        "summary": "测试网络链接",
        "description": "获取网络状态信息和版本信息",
        "responses": {
          "200": {
            "description": "操作成功"
          }
        }
      }
    },
    "/cloud/cluster/nodes": {
      "get": {
        "tags": [
          "cluster"
        ],
        "summary": "获取节点数据",
        "description": "获取指定节点数据",
        "parameters": [
          {
            "name": "clusterid",
            "in": "query",
            "required": true,
            "type": "string"
          }
        ],
        "responses": {
          "200": {
            "description": "操作成功",
            "schema": {
              "$ref": "#/definitions/NodeInfo"
            }
          }
        }
      }
    },
    "/cloud/cluster/info": {
      "get": {
        "tags": [
          "cluster"
        ],
        "summary": "获取当前账户下所有的K8s集群列表",
        "description": "查询集群节点信息",
        "produces": [
          "text/plain"
        ],
        "parameters": [
          {
            "in": "query",
            "name": "region",
            "description": "集群所在区域",
            "required": true,
            "type": "string"
          }
        ],
        "responses": {
          "200": {
            "description": "信息获取成功",
            "schema": {
              "$ref": "#/definitions/ClusterInfo"
            }
          },
          "500": {
            "description": "地址获取失败"
          }
        }
      },
      "post": {
        "tags": [
          "cluster"
        ],
        "summary": "查询并更新集群节点信息",
        "description": "更新集群节点信息",
        "produces": [
          "application/json"
        ],
        "parameters": [
          {
            "in": "query",
            "name": "region",
            "description": "集群所在区域",
            "required": true,
            "type": "string"
          },
          {
            "name": "save",
            "in": "query",
            "description": "是否需要保存",
            "required": false,
            "type": "boolean"
          }
        ],
        "responses": {
          "200": {
            "description": "信息获取成功",
            "schema": {
              "$ref": "#/definitions/ClusterInfo"
            }
          },
          "500": {
            "description": "地址获取失败"
          }
        }
      }
    },
    "/svc/dns/a-record": {
      "post": {
        "tags": [
          "dns"
        ],
        "summary": "增加A记录",
        "description": "增加指定域名的A记录, 与POST/dns/metadata重复",
        "parameters": [
          {
            "name": "body",
            "in": "body",
            "required": true,
            "schema": {
              "$ref": "#/definitions/DnsInfo"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "操作成功"
          },
          "500": {
            "description": "操作失败"
          }
        }
      }
    },
    "/cloud/metadata": {
      "post": {
        "tags": [
          "metadata"
        ],
        "summary": "设定集群操作元数据",
        "description": "设定操作集群所需的密钥信息和区域信息",
        "produces": [
          "application/json"
        ],
        "parameters": [
          {
            "in": "body",
            "name": "body",
            "description": "元数据",
            "required": true,
            "schema": {
              "$ref": "#/definitions/MetaData"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "设定成功"
          },
          "500": {
            "description": "设定失败"
          }
        }
      },
      "get": {
        "tags": [
          "metadata"
        ],
        "summary": "获取元数据",
        "description": "获取指定区域的元数据",
        "produces": [
          "application/json"
        ],
        "parameters": [
          {
            "in": "query",
            "name": "region",
            "description": "区域名称",
            "required": false,
            "type": "string"
          }
        ],
        "responses": {
          "200": {
            "description": "操作成功",
            "schema": {
              "$ref": "#/definitions/MetaData"
            }
          }
        }
      }
    },
    "/cloud/svc/info/sample": {
      "get": {
        "tags": [
          "svc"
        ],
        "parameters": [
          {
            "name": "region",
            "in": "query",
            "required": true,
            "type": "string",
            "description": "机房所在区域"
          },
          {
            "name": "clusterid",
            "in": "query",
            "required": true,
            "type": "string",
            "description": "集群名称"
          },
          {
            "name": "namespace",
            "in": "query",
            "required": false,
            "type": "string",
            "description": "命名空间名称,默认为default"
          }
        ],
        "summary": "获取服务简要描述",
        "description": "获取服务概述",
        "responses": {
          "200": {
            "description": "操作成功",
            "schema": {
              "$ref": "#/definitions/SvcInfo"
            }
          }
        }
      }
    },
    "/cloud/svcconf/create": {
      "post": {
        "tags": [
          "svc"
        ],
        "summary": "新建服务配置信息",
        "description": "新建用户服务配置信息",
        "produces": [
          "application/json"
        ],
        "parameters": [
          {
            "in": "body",
            "name": "body",
            "description": "配置信息",
            "required": true,
            "schema": {
              "$ref": "#/definitions/SvcConfig"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "创建成功"
          },
          "500": {
            "description": "创建失败"
          }
        }
      }
    },
    "/cloud/svcconf/info": {
      "get": {
        "tags": [
          "svc"
        ],
        "summary": "获取配置数据",
        "description": "获取指定服务配置数据",
        "produces": [
          "application/json"
        ],
        "parameters": [
          {
            "in": "query",
            "name": "namespace",
            "description": "命名空间名称,",
            "required": true,
            "type": "string"
          },
          {
            "in": "query",
            "name": "id",
            "description": "配置ID,如果存在ID，则直接查询此ID所对应的配置信息。如果不上送ID，则查询此命名空间下的所有配置信息",
            "required": false,
            "type": "string"
          }
        ],
        "responses": {
          "200": {
            "description": "操作成功",
            "schema": {
              "$ref": "#/definitions/SvcConfig"
            }
          },
          "500": {
            "description": "操作失败"
          }
        }
      }
    },
    "/cloud/svcconf/status": {
      "get": {
        "tags": [
          "svc"
        ],
        "summary": "获取配置数据当前状态",
        "description": "获取当前配置的网络解析状态",
        "produces": [
          "application/json"
        ],
        "parameters": [
          {
            "in": "query",
            "name": "namespace",
            "description": "命名空间名称,若为空，则使用默认空间",
            "required": false,
            "type": "string"
          },
          {
            "in": "query",
            "name": "svc",
            "description": "服务配置名称",
            "required": true,
            "type": "string"
          }
        ],
        "responses": {
          "200": {
            "description": "操作成功",
            "schema": {
              "$ref": "#/definitions/SvcConfStatus"
            }
          },
          "500": {
            "description": "操作失败"
          }
        }
      }
    },
    "/cloud/svcconf/delete": {
      "post": {
        "tags": [
          "svc"
        ],
        "summary": "删除配置数据",
        "description": "删除指定服务配置数据",
        "produces": [
          "application/json"
        ],
        "parameters": [
          {
            "in": "query",
            "name": "namespace",
            "description": "命名空间名称,",
            "required": true,
            "type": "string"
          },
          {
            "in": "query",
            "name": "id",
            "description": "配置ID,如果存在ID，则删除此ID所对应的配置信息。如果不上送ID，则删除此命名空间下的所有配置信息",
            "required": false,
            "type": "string"
          }
        ],
        "responses": {
          "200": {
            "description": "操作成功"
          },
          "500": {
            "description": "操作失败"
          }
        }
      }
    },
    "/cloud/svcconf/check": {
      "post": {
        "tags": [
          "svc"
        ],
        "summary": "确认服务配置信息是否存在",
        "description": "如果服务配置信息已存在，则更新其数据。 如果不存在则创建新配置信息",
        "produces": [
          "application/json"
        ],
        "parameters": [
          {
            "in": "body",
            "name": "body",
            "description": "配置信息",
            "required": true,
            "schema": {
              "$ref": "#/definitions/SvcConfig"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "创建成功",
            "schema": {
              "$ref": "#/definitions/UpgradeMsg"
            }
          },
          "500": {
            "description": "创建失败"
          }
        }
      }
    },
    "/cloud/svc/upgrade": {
      "post": {
        "tags": [
          "svc"
        ],
        "summary": "更改配置数据",
        "description": "更改指定服务配置数据",
        "produces": [
          "application/json"
        ],
        "parameters": [
          {
            "in": "query",
            "name": "id",
            "description": "配置ID",
            "required": true,
            "type": "string"
          },
          {
            "in": "body",
            "name": "body",
            "description": "配置项数据",
            "required": true,
            "schema": {
              "$ref": "#/definitions/SvcConfig"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "操作成功",
            "schema": {
              "$ref": "#/definitions/SvcInfo"
            }
          },
          "500": {
            "description": "操作失败"
          }
        }
      }
    },
    "/cloud/svc/deploy": {
      "post": {
        "tags": [
          "svc"
        ],
        "summary": "部署服务实例",
        "description": "如果K8s服务实例已存在，则更新配置。 如果不存在，则创建",
        "produces": [
          "application/json"
        ],
        "parameters": [
          {
            "in": "query",
            "name": "svcname",
            "description": "服务配置名称",
            "required": true,
            "type": "string"
          },
          {
            "in": "query",
            "name": "namespace",
            "description": "命名空间名称。如果为空，则取默认值",
            "required": false,
            "type": "string"
          }
        ],
        "responses": {
          "200": {
            "description": "操作成功",
            "schema": {
              "$ref": "#/definitions/SvcInfo"
            }
          },
          "500": {
            "description": "操作失败"
          }
        }
      }
    },
    "/cloud/svc/run": {
      "post": {
        "tags": [
          "svc"
        ],
        "summary": "创建服务实例",
        "description": "执行/替换指定服务实例",
        "produces": [
          "application/json"
        ],
        "parameters": [
          {
            "in": "query",
            "name": "svcid",
            "description": "配置项ID",
            "required": true,
            "type": "string"
          },
          {
            "in": "query",
            "name": "clusterid",
            "description": "集群ID",
            "required": true,
            "type": "string"
          },
          {
            "in": "query",
            "name": "upgrade",
            "description": "是否为替换,如果为true则会使用最新的配置数据创建服务实例。 默认为false",
            "required": false,
            "type": "string"
          }
        ],
        "responses": {
          "200": {
            "description": "操作成功",
            "schema": {
              "$ref": "#/definitions/SvcInfo"
            }
          },
          "500": {
            "description": "操作失败"
          }
        }
      }
    },
    "/cloud/svc/delete": {
      "post": {
        "tags": [
          "svc"
        ],
        "summary": "删除服务实例",
        "description": "删除指定服务实例",
        "produces": [
          "application/json"
        ],
        "parameters": [
          {
            "in": "query",
            "name": "clusterid",
            "description": "集群ID",
            "required": true,
            "type": "string"
          },
          {
            "in": "query",
            "name": "id",
            "description": "配置ID",
            "required": true,
            "type": "string"
          }
        ],
        "responses": {
          "200": {
            "description": "操作成功"
          },
          "500": {
            "description": "操作失败"
          }
        }
      }
    },
    "/cloud/svc/reinstall": {
      "post": {
        "tags": [
          "svc"
        ],
        "summary": "重新部署服务实例",
        "description": "重新部署指定服务实例",
        "produces": [
          "application/json"
        ],
        "parameters": [
          {
            "in": "query",
            "name": "clusterid",
            "description": "集群ID",
            "required": true,
            "type": "string"
          },
          {
            "in": "query",
            "name": "svcname",
            "description": "服务名称, 当提供服务名称时必须提供命名空间",
            "required": false,
            "type": "string"
          },
          {
            "in": "query",
            "name": "namespace",
            "description": "命名空间名称",
            "required": false,
            "type": "string"
          },
          {
            "in": "query",
            "name": "id",
            "description": "配置ID,当提供服务名称时此项可不提供",
            "required": false,
            "type": "string"
          }
        ],
        "responses": {
          "200": {
            "description": "操作成功"
          },
          "500": {
            "description": "操作失败"
          }
        }
      }
    },
    "/cloud/svc/status": {
      "get": {
        "tags": [
          "svc"
        ],
        "summary": "查询服务实例状态",
        "description": "查询指定服务实例的简要状态",
        "produces": [
          "application/json"
        ],
        "parameters": [
          {
            "in": "query",
            "name": "svcname",
            "description": "服务名称, 当提供服务名称时必须提供命名空间",
            "required": false,
            "type": "string"
          },
          {
            "in": "query",
            "name": "id",
            "description": "配置ID,当提供服务名称时此项可不提供",
            "required": false,
            "type": "string"
          }
        ],
        "responses": {
          "200": {
            "description": "操作成功"
          },
          "500": {
            "description": "操作失败"
          }
        }
      }
    },
    "/cloud/svc/rolling": {
      "post": {
        "tags": [
          "svc"
        ],
        "summary": "进行滚动升级(蓝绿/金丝雀)",
        "description": "对未升级的实例按照给定的比例进行升级",
        "produces": [
          "application/json"
        ],
        "parameters": [
          {
            "in": "query",
            "name": "svcname",
            "required": true,
            "description": "服务配置名称",
            "type": "string"
          },
          {
            "in": "query",
            "name": "namespace",
            "required": false,
            "description": "命名空间名称,为空则取默认值",
            "type": "string"
          },
          {
            "in": "query",
            "name": "percent",
            "required": false,
            "description": "升级百分比",
            "type": "number"
          }
        ],
        "responses": {
          "200": {
            "description": "操作成功"
          },
          "500": {
            "description": "操作失败"
          }
        }
      }
    },
    "/cluod/svc/group/add": {
      "post": {
        "tags": [
          "svcor"
        ],
        "summary": "增加服务编排",
        "description": "创建一条新的服务编排信息",
        "produces": [
          "application/json"
        ],
        "parameters": [
          {
            "in": "query",
            "name": "name",
            "description": "服务编排配置名称",
            "required": true,
            "type": "string"
          },
          {
            "in": "query",
            "name": "clusterid",
            "description": "集群ID",
            "required": true,
            "type": "string"
          },
          {
            "in": "query",
            "name": "namespace",
            "description": "服务所在命名空间",
            "required": true,
            "type": "string"
          },
          {
            "in": "query",
            "name": "svcname",
            "description": "服务名称,必须已经提前创建",
            "required": true,
            "type": "string"
          },
          {
            "in": "query",
            "name": "idx",
            "description": "服务执行顺序",
            "required": true,
            "type": "number"
          }
        ],
        "responses": {
          "200": {
            "description": "操作成功"
          },
          "500": {
            "description": "操作失败"
          }
        }
      }
    },
    "/cloud/svc/group/info": {
      "get": {
        "tags": [
          "svcor"
        ],
        "summary": "获取指定服务编排",
        "description": "根据命名空间和编排名称获取服务编排信息",
        "produces": [
          "application/json"
        ],
        "parameters": [
          {
            "in": "query",
            "name": "name",
            "description": "服务编排配置名称",
            "required": false,
            "type": "string"
          },
          {
            "in": "query",
            "name": "namespace",
            "description": "服务所在命名空间",
            "required": true,
            "type": "string"
          }
        ],
        "responses": {
          "200": {
            "description": "操作成功",
            "schema": {
              "$ref": "#/definitions/UpgradeMsg"
            }
          },
          "500": {
            "description": "操作失败"
          }
        }
      }
    },
    "/cloud/svc/group/delete": {
      "post": {
        "tags": [
          "svcor"
        ],
        "summary": "删除服务编排数据",
        "description": "删除一条服务编排信息",
        "produces": [
          "application/json"
        ],
        "parameters": [
          {
            "in": "query",
            "name": "name",
            "description": "服务编排配置名称",
            "required": true,
            "type": "string"
          },
          {
            "in": "query",
            "name": "namespace",
            "description": "服务所在命名空间",
            "required": true,
            "type": "string"
          },
          {
            "in": "query",
            "name": "svcname",
            "description": "如果不提供，则删除此编排信息。 如果提供，则只删除这条服务依赖数据",
            "required": false,
            "type": "string"
          }
        ],
        "responses": {
          "200": {
            "description": "操作成功"
          },
          "500": {
            "description": "操作失败"
          }
        }
      }
    },
    "/cloud/svc/group/run": {
      "post": {
        "tags": [
          "svcor"
        ],
        "summary": "执行服务编排",
        "description": "执行设定好的服务编排",
        "produces": [
          "application/json"
        ],
        "parameters": [
          {
            "in": "query",
            "name": "clusterid",
            "description": "集群节点名称",
            "required": true,
            "type": "string"
          },
          {
            "in": "query",
            "name": "namespace",
            "description": "服务所在命名空间",
            "required": true,
            "type": "string"
          },
          {
            "in": "query",
            "name": "svcgroup",
            "description": "服务编排名称",
            "required": true,
            "type": "string"
          }
        ],
        "responses": {
          "200": {
            "description": "操作成功"
          },
          "500": {
            "description": "操作失败"
          }
        }
      }
    },
    "/cloud/svc/group/reinstall": {
      "post": {
        "tags": [
          "svcor"
        ],
        "summary": "重新部署服务编排",
        "description": "重新部署设定好的服务编排,此操作将会重启服务编排中设定好的所有服务",
        "produces": [
          "application/json"
        ],
        "parameters": [
          {
            "in": "query",
            "name": "clusterid",
            "description": "集群节点名称",
            "required": true,
            "type": "string"
          },
          {
            "in": "query",
            "name": "namespace",
            "description": "服务所在命名空间",
            "required": true,
            "type": "string"
          },
          {
            "in": "query",
            "name": "svcgroup",
            "description": "服务编排名称",
            "required": true,
            "type": "string"
          }
        ],
        "responses": {
          "200": {
            "description": "操作成功"
          },
          "500": {
            "description": "操作失败"
          }
        }
      }
    },
    "/cloud/svc/group/uninsall": {
      "post": {
        "tags": [
          "svcor"
        ],
        "summary": "卸载服务编排",
        "description": "卸载设定好的服务编排,此操作将会删除服务编排中设定好的所有服务",
        "produces": [
          "application/json"
        ],
        "parameters": [
          {
            "in": "query",
            "name": "clusterid",
            "description": "集群节点名称",
            "required": true,
            "type": "string"
          },
          {
            "in": "query",
            "name": "namespace",
            "description": "服务所在命名空间",
            "required": true,
            "type": "string"
          },
          {
            "in": "query",
            "name": "svcgroup",
            "description": "服务编排名称",
            "required": true,
            "type": "string"
          }
        ],
        "responses": {
          "200": {
            "description": "操作成功"
          },
          "500": {
            "description": "操作失败"
          }
        }
      }
    },
    "/cloud/namespace/create": {
      "post": {
        "tags": [
          "namespace"
        ],
        "summary": "创建新的命名空间",
        "description": "创建新的命名空间",
        "produces": [
          "application/json"
        ],
        "parameters": [
          {
            "in": "query",
            "name": "clusterid",
            "description": "集群ID",
            "required": true,
            "type": "string"
          },
          {
            "in": "query",
            "name": "name",
            "description": "命名空间名称",
            "required": true,
            "type": "string"
          },
          {
            "in": "query",
            "name": "desc",
            "description": "命名空间描述",
            "required": false,
            "type": "string"
          }
        ],
        "responses": {
          "200": {
            "description": "操作成功"
          },
          "500": {
            "description": "操作失败"
          }
        }
      }
    },
    "/cloud/namespace/delete": {
      "post": {
        "tags": [
          "namespace"
        ],
        "summary": "删除命名空间",
        "description": "删除命名空间",
        "produces": [
          "application/json"
        ],
        "parameters": [
          {
            "in": "query",
            "name": "clusterid",
            "description": "集群ID",
            "required": true,
            "type": "string"
          },
          {
            "in": "query",
            "name": "name",
            "description": "命名空间名称",
            "required": true,
            "type": "string"
          }
        ],
        "responses": {
          "200": {
            "description": "操作成功"
          },
          "500": {
            "description": "操作失败"
          }
        }
      }
    },
    "/cloud/namespace/info": {
      "post": {
        "tags": [
          "namespace"
        ],
        "summary": "更新指定命名空间数据",
        "description": "同步指定的命名空间数据",
        "produces": [
          "application/json"
        ],
        "parameters": [
          {
            "in": "query",
            "name": "clusterid",
            "description": "集群ID",
            "required": true,
            "type": "string"
          },
          {
            "in": "query",
            "name": "save",
            "description": "是否保存数据, 默认为false",
            "required": false,
            "type": "boolean"
          }
        ],
        "responses": {
          "200": {
            "description": "操作成功"
          },
          "500": {
            "description": "操作失败"
          }
        }
      },
      "get": {
        "tags": [
          "namespace"
        ],
        "summary": "获取指定命名空间数据",
        "description": "获取指定的命名空间数据",
        "produces": [
          "application/json"
        ],
        "parameters": [
          {
            "in": "query",
            "name": "clusterid",
            "description": "集群ID",
            "required": true,
            "type": "string"
          },
          {
            "in": "query",
            "name": "name",
            "description": "命名空间名称，如果为空则返回此集群下所有命名空间数据",
            "required": false,
            "type": "string"
          }
        ],
        "responses": {
          "200": {
            "description": "操作成功",
            "schema": {
              "$ref": "#/definitions/Namespace"
            }
          },
          "500": {
            "description": "操作失败"
          }
        }
      }
    },
    "/cloud/namespace/check": {
      "post": {
        "tags": [
          "namespace"
        ],
        "summary": "确认命名空间是否存在",
        "description": "如果不存在则直接创建",
        "produces": [
          "application/json"
        ],
        "parameters": [
          {
            "in": "query",
            "name": "clusterid",
            "description": "集群ID",
            "required": true,
            "type": "string"
          },
          {
            "in": "query",
            "name": "name",
            "description": "命名空间名称",
            "required": true,
            "type": "string"
          },
          {
            "in": "query",
            "name": "desc",
            "description": "命名空间描述",
            "required": false,
            "type": "string"
          }
        ],
        "responses": {
          "200": {
            "description": "操作成功",
            "schema": {
              "$ref": "#/definitions/UpgradeMsg"
            }
          },
          "500": {
            "description": "操作失败"
          }
        }
      }
    },
    "/dns/metadata": {
      "get": {
        "tags": [
          "dns"
        ],
        "summary": "获取指定域名的DNS记录",
        "description": "获取DNS记录",
        "produces": [
          "text/plain"
        ],
        "parameters": [
          {
            "in": "query",
            "name": "domain",
            "description": "域名",
            "required": true,
            "type": "string"
          },
          {
            "in": "query",
            "name": "fuzzy",
            "description": "是否需要模糊查询",
            "required": false,
            "type": "boolean"
          }
        ],
        "responses": {
          "200": {
            "description": "操作成功",
            "schema": {
              "$ref": "#/definitions/DnsInfo"
            }
          }
        }
      },
      "post": {
        "tags": [
          "dns"
        ],
        "summary": "增加指定的域名DNS记录",
        "description": "增加DNS记录",
        "produces": [
          "application/json"
        ],
        "parameters": [
          {
            "in": "body",
            "name": "body",
            "description": "DNS数据",
            "required": true,
            "schema": {
              "$ref": "#/definitions/DnsInfo"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "操作成功"
          },
          "500": {
            "description": "操作失败"
          }
        }
      },
      "delete": {
        "tags": [
          "dns"
        ],
        "summary": "删除指定的域名DNS记录",
        "description": "删除DNS记录",
        "produces": [
          "application/json"
        ],
        "parameters": [
          {
            "in": "body",
            "name": "body",
            "description": "DNS数据",
            "required": true,
            "schema": {
              "$ref": "#/definitions/DnsInfo"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "操作成功"
          },
          "500": {
            "description": "操作失败"
          }
        }
      }
    },
    "/cloud/container/create": {
      "post": {
        "tags": [
          "container"
        ],
        "summary": "新建容器配置数据",
        "description": "新建容器配置数据",
        "produces": [
          "application/json"
        ],
        "parameters": [
          {
            "in": "body",
            "name": "body",
            "description": "容器数据",
            "required": true,
            "schema": {
              "$ref": "#/definitions/Container"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "操作成功"
          },
          "500": {
            "description": "操作失败"
          }
        }
      }
    },
    "/cloud/container/info": {
      "get": {
        "tags": [
          "container"
        ],
        "summary": "获取容器配置信息",
        "description": "获取容器配置信息",
        "produces": [
          "application/json"
        ],
        "parameters": [
          {
            "in": "query",
            "name": "namespace",
            "description": "命名空间名称",
            "required": true,
            "type": "string"
          },
          {
            "in": "query",
            "name": "svc",
            "description": "服务名称",
            "required": true,
            "type": "string"
          },
          {
            "in": "query",
            "name": "cid",
            "description": "容器ID,如果为空，则返回此服务下所有的容器数据",
            "required": false,
            "type": "string"
          }
        ],
        "responses": {
          "200": {
            "description": "操作成功",
            "schema": {
              "$ref": "#/definitions/Container"
            }
          },
          "500": {
            "description": "操作失败"
          }
        }
      }
    },
    "/cloud/container/delete": {
      "post": {
        "tags": [
          "container"
        ],
        "summary": "删除容器配置信息",
        "description": "删除容器配置信息",
        "produces": [
          "application/json"
        ],
        "parameters": [
          {
            "in": "query",
            "name": "namespace",
            "description": "命名空间名称",
            "required": true,
            "type": "string"
          },
          {
            "in": "query",
            "name": "svc",
            "description": "服务名称",
            "required": true,
            "type": "string"
          },
          {
            "in": "query",
            "name": "cid",
            "description": "容器ID,如果为空，则删除此服务下所有的容器数据",
            "required": false,
            "type": "string"
          }
        ],
        "responses": {
          "200": {
            "description": "操作成功"
          },
          "500": {
            "description": "操作失败"
          }
        }
      }
    },
    "/cloud/container/check": {
      "post": {
        "tags": [
          "container"
        ],
        "summary": "检查容器配置数据是否存在",
        "description": "如果配置数据不存在则直接创建, 如果已经存在则进行更新",
        "produces": [
          "application/json"
        ],
        "parameters": [
          {
            "in": "body",
            "name": "body",
            "description": "容器数据",
            "required": true,
            "schema": {
              "$ref": "#/definitions/Container"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "操作成功"
          },
          "500": {
            "description": "操作失败"
          }
        }
      }
    },
    "/cloud/contianer/upgrade": {
      "post": {
        "tags": [
          "container"
        ],
        "summary": "更新容器配置数据",
        "description": "如果选择更新，则删除同一服务配置下的所有容器配置信息。否则追加本条配置信息",
        "produces": [
          "application/json"
        ],
        "parameters": [
          {
            "in": "body",
            "name": "body",
            "description": "容器数据",
            "required": true,
            "schema": {
              "$ref": "#/definitions/Container"
            }
          },
          {
            "in": "query",
            "name": "rmall",
            "description": "是否更新所在服务配置下的其它容器信息",
            "type": "boolean",
            "required": true
          }
        ],
        "responses": {
          "200": {
            "description": "操作成功"
          },
          "500": {
            "description": "操作失败"
          }
        }
      }
    }
  },
  "definitions": {
    "MetaData": {
      "type": "object",
      "properties": {
        "secret_id": {
          "type": "string",
          "description": "密钥ID",
          "example": "123"
        },
        "secret_key": {
          "type": "string",
          "description": "密钥值",
          "example": "xxddys==="
        },
        "region": {
          "type": "string",
          "description": "机房区域",
          "example": "sh"
        }
      }
    },
    "DnsInfo": {
      "type": "object",
      "properties": {
        "key": {
          "type": "string",
          "description": "域名",
          "example": "zk.eqshow.cn"
        },
        "value": {
          "$ref": "#/definitions/DNSValue"
        }
      }
    },
    "DNSValue": {
      "type": "object",
      "properties": {
        "host": {
          "type": "string",
          "description": "IP地址",
          "example": "172.0.0.3"
        },
        "port": {
          "type": "integer",
          "description": "服务端口",
          "example": "80"
        }
      }
    },
    "NodeInfo": {
      "type": "object",
      "properties": {
        "host": {
          "type": "string",
          "description": "IP地址",
          "example": "172.0.0.3"
        }
      }
    },
    "SvcInfo": {
      "type": "object",
      "properties": {
        "code": {
          "type": "number",
          "description": "响应码",
          "example": 200
        },
        "message": {
          "type": "string",
          "description": "返回信息"
        },
        "codedesc": {
          "type": "string",
          "description": "响应码描述"
        },
        "data": {
          "$ref": "#/definitions/SvcData"
        }
      }
    },
    "SvcData": {
      "type": "object",
      "properties": {
        "totalcount": {
          "type": "number",
          "description": "服务个数",
          "example": 1
        },
        "services": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/SvcContent"
          }
        }
      }
    },
    "SvcContent": {
      "type": "object",
      "properties": {
        "servicename": {
          "type": "string",
          "description": "服务名称",
          "example": "zk-cn"
        },
        "status": {
          "type": "string",
          "description": "服务状态",
          "example": "Normal"
        },
        "serviceip": {
          "type": "string",
          "description": "服务IP",
          "example": "172.0.0.4"
        },
        "externalip": {
          "type": "string",
          "description": "对外服务IP",
          "example": "192.0.0.4"
        },
        "lbid": {
          "type": "string",
          "description": "负载名称",
          "example": "lb-cluster-1"
        },
        "lbstatus": {
          "type": "string",
          "description": "负载状态",
          "example": "Running"
        },
        "accesstype": {
          "type": "string",
          "description": "访问方式",
          "example": "ClusterIP"
        },
        "desiredreplicas": {
          "type": "number",
          "description": "预设副本个数",
          "example": "3"
        },
        "currentreplicas": {
          "type": "number",
          "description": "当前副本个数",
          "example": "2"
        },
        "createdat": {
          "type": "string",
          "description": "创建时间",
          "example": "2017-12-25 11:02:42"
        },
        "namespace": {
          "type": "string",
          "description": "所处命名空间",
          "example": "mynamespace"
        }
      }
    },
    "ClusterInfo": {
      "type": "object",
      "properties": {
        "code": {
          "type": "number",
          "description": "响应码",
          "example": 200
        },
        "message": {
          "type": "string",
          "description": "返回信息"
        },
        "codedesc": {
          "type": "string",
          "description": "响应码描述"
        },
        "data": {
          "$ref": "#/definitions/ClusterData"
        }
      }
    },
    "ClusterData": {
      "type": "object",
      "properties": {
        "totalcount": {
          "type": "number",
          "description": "服务个数",
          "example": 1
        },
        "clusters": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/ClusterContent"
          }
        }
      }
    },
    "ClusterContent": {
      "type": "object",
      "properties": {
        "clusterid": {
          "type": "string",
          "description": "集群ID",
          "example": "zk-cn"
        },
        "clustername": {
          "type": "string",
          "description": "集群名称",
          "example": "Cluster_01"
        },
        "description": {
          "type": "string",
          "description": "集群描述",
          "example": "My K8s Cluster"
        },
        "status": {
          "type": "string",
          "description": "集群状态",
          "example": "Running"
        },
        "unvpcid": {
          "type": "string",
          "description": "集群私有网络名称",
          "example": "vpc-xxxx"
        },
        "vpcid": {
          "type": "number",
          "description": "集群私有网络ID",
          "example": "895"
        },
        "clustercidr": {
          "type": "string",
          "description": "集群容器和服务 IP 的 CIDR",
          "example": "172.21.0.0/16"
        },
        "createdat": {
          "type": "string",
          "description": "创建时间",
          "example": "2017-02-25 11:02:42"
        },
        "updatedat": {
          "type": "string",
          "description": "更新时间",
          "example": "2017-03-24 11:13:01"
        },
        "nodestatus": {
          "type": "string",
          "description": "节点状态",
          "example": "AllNormal"
        },
        "nodenum": {
          "type": "number",
          "description": "节点数量",
          "example": 4
        },
        "os": {
          "type": "string",
          "description": "操作系统",
          "example": "ubuntu16.04.1 LTSx86_64"
        },
        "totalcpu": {
          "type": "number",
          "description": "CPU总算力",
          "example": "16"
        },
        "totalmem": {
          "type": "number",
          "description": "内存总量",
          "example": 64
        },
        "regionid": {
          "type": "number",
          "description": "区域ID",
          "example": 1
        },
        "k8sversion": {
          "type": "string",
          "description": "K8s版本信息",
          "example": "1.7.2"
        },
        "openhttps": {
          "type": "number",
          "description": "",
          "example": 0
        },
        "masterlbsubnetid": {
          "type": "string",
          "description": "",
          "example": ""
        },
        "projectid": {
          "type": "number",
          "description": "",
          "example": 0
        },
        "region": {
          "type": "string",
          "description": "所在区域名称",
          "example": "sh"
        }
      }
    },
    "SvcConfig": {
      "type": "object",
      "properties": {
        "name": {
          "type": "string",
          "description": "配置名称",
          "example": "apitest"
        },
        "desc": {
          "type": "string",
          "description": "配置描述",
          "example": "this is a desc"
        },
        "replicas": {
          "type": "number",
          "description": "服务实例个数, 默认为1",
          "example": 1
        },
        "namespace": {
          "type": "string",
          "description": "服务所处命名空间名称,默认为devenv",
          "example": "ns-test"
        },
        "netconf": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/Netconfig"
          }
        }
      }
    },
    "Netconfig": {
      "type": "object",
      "properties": {
        "access_type": {
          "type": "number",
          "description": "网络访问类型。 0-集群内访问 1-外网负载 2-内网负载 默认为0",
          "example": 0
        },
        "in_port": {
          "type": "number",
          "description": "容器内监听端口",
          "example": 8000
        },
        "out_port": {
          "type": "number",
          "description": "服务负载监听端口,端口冲突时会累加",
          "example": 8000
        },
        "protocol": {
          "type": "number",
          "description": "协议类型 0-TCP 1-UDP,默认为0",
          "example": 0
        }
      }
    },
    "Namespace": {
      "type": "object",
      "properties": {
        "name": {
          "type": "string",
          "description": "命名空间名称",
          "example": "apitest"
        },
        "description": {
          "type": "string",
          "description": "命名空间描述",
          "example": "this is a desc"
        },
        "status": {
          "type": "string",
          "description": "命名空间当前状态",
          "example": "Active"
        },
        "createdat": {
          "type": "string",
          "description": "命名空间创建时间",
          "example": "2017-12-19 11:01:32"
        },
        "cluster_id": {
          "type": "string",
          "description": "所在的集群ID",
          "example": "cls-rfje0azd"
        }
      }
    },
    "Container": {
      "type": "object",
      "properties": {
        "name": {
          "type": "string",
          "description": "容器名称,如果为空则默认取镜像名",
          "example": "apitest"
        },
        "img": {
          "type": "string",
          "description": "镜像名称",
          "example": "hello-world"
        },
        "cmd": {
          "type": "array",
          "description": "命令参数",
          "items": {
            "type": "string"
          }
        },
        "env": {
          "$ref": "#/definitions/ContainerEnv"
        },
        "svc": {
          "type": "string",
          "description": "所属服务配置名称",
          "example": "svctest"
        },
        "namespace": {
          "type": "string",
          "description": "所属命名空间名称",
          "example": "nstest"
        },
        "idx": {
          "type": "number",
          "description": "容器在服务实例中的执行顺序",
          "example": 1
        }
      }
    },
    "ContainerEnv": {
      "type": "object",
      "additionalProperties": {
        "type": "string"
      }
    },
    "UpgradeMsg": {
      "type": "object",
      "properties": {
        "code": {
          "type": "number",
          "description": "响应码 0:没有匹配数据 1000:操作成功 1001:操作失败",
          "example": "1000"
        },
        "msg": {
          "type": "string",
          "description": "响应描述",
          "example": ""
        },
        "data": {
          "type": "string",
          "description": "返回的响应数据, 依据所调用的接口不同，返回不同的数据结构"
        }
      }
    },
    "SvcGroup": {
      "type": "object",
      "properties": {
        "Id": {
          "type": "string",
          "description": "编排ID"
        },
        "svc_group": {
          "$ref": "#/definitions/SvcGroupInfo"
        },
        "namespace": {
          "type": "string",
          "description": "命名空间"
        },
        "clusterid": {
          "type": "string",
          "description": "集群ID"
        },
        "name": {
          "type": "string",
          "description": "编排名称"
        }
      }
    },
    "SvcGroupInfo": {
      "type": "object",
      "additionalProperties": {
        "type": "number",
        "description": "服务执行顺序",
        "example": 1
      }
    },
    "SvcConfStatus": {
      "type": "object",
      "properties": {
        "status": {
          "type": "string",
          "description": "当前部署状态 ready-等待部署 normal-部署成功 updating-部署中 rolling-蓝绿发布进行中 failed-部署失败"
        },
        "lb_ip": {
          "type": "string",
          "description": "服务负载均衡IP"
        },
        "lb_port": {
          "type": "array",
          "description": "服务负载均衡监听端口",
          "items": {
            "type": "number"
          }
        },
        "replicas": {
          "type": "number",
          "description": "实例个数"
        },
        "msg": {
          "type": "string",
          "description": "错误消息"
        }
      }
    }
  }
}
